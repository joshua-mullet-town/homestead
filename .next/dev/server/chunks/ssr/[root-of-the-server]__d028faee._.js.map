{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///Users/joshuamullet/code/homestead/app/terminal/%5BsessionId%5D/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useRef, useState } from 'react';\nimport { useParams } from 'next/navigation';\nimport { io, Socket } from 'socket.io-client';\n\nexport default function TerminalPage() {\n  const params = useParams();\n  const sessionId = params.sessionId as string;\n  const terminalRef = useRef<HTMLDivElement>(null);\n  const xtermRef = useRef<any>(null);\n  const socketRef = useRef<Socket | null>(null);\n  const [isConnected, setIsConnected] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    let xterm: any;\n    let fitAddon: any;\n    let mounted = true;\n\n    const initTerminal = async () => {\n      try {\n        // Dynamically import xterm to avoid SSR issues\n        const [{ Terminal }, { FitAddon }] = await Promise.all([\n          import('@xterm/xterm'),\n          import('@xterm/addon-fit')\n        ]);\n\n        if (!mounted) return;\n\n        // Create terminal instance\n        xterm = new Terminal({\n          cols: 100,\n          rows: 30,\n          fontSize: 14,\n          fontFamily: 'Menlo, Monaco, \"Courier New\", monospace',\n          cursorBlink: true,\n          theme: {\n            background: '#1e1e1e',\n            foreground: '#d4d4d4',\n            cursor: '#d4d4d4',\n            cursorAccent: '#1e1e1e',\n            selection: 'rgba(255, 255, 255, 0.3)',\n          }\n        });\n\n        fitAddon = new FitAddon();\n        xterm.loadAddon(fitAddon);\n\n        // Mount terminal\n        if (terminalRef.current) {\n          xterm.open(terminalRef.current);\n          fitAddon.fit();\n          xtermRef.current = xterm;\n        }\n\n        // Connect to Socket.IO - use current hostname so it works on mobile\n        const socketUrl = typeof window !== 'undefined'\n          ? `http://${window.location.hostname}:3005`\n          : 'http://localhost:3005';\n\n        const socket = io(socketUrl, {\n          transports: ['websocket', 'polling']\n        });\n\n        socketRef.current = socket;\n\n        socket.on('connect', () => {\n          console.log('[Socket] Connected');\n          setIsConnected(true);\n          setError(null);\n\n          // Create terminal session\n          socket.emit('terminal:create', sessionId, '/Users/joshuamullet/code');\n        });\n\n        socket.on('disconnect', () => {\n          console.log('[Socket] Disconnected');\n          setIsConnected(false);\n        });\n\n        socket.on('terminal:ready', (sid) => {\n          console.log('[Terminal] Ready:', sid);\n          xterm.write('\\r\\n\\x1b[1;32mTerminal connected!\\x1b[0m\\r\\n');\n        });\n\n        socket.on('terminal:output', (sid, data) => {\n          if (sid === sessionId) {\n            xterm.write(data);\n          }\n        });\n\n        socket.on('terminal:exit', (sid, { exitCode }) => {\n          console.log(`[Terminal] Exited with code ${exitCode}`);\n          xterm.write(`\\r\\n\\r\\n\\x1b[1;31mProcess exited with code ${exitCode}\\x1b[0m\\r\\n`);\n        });\n\n        socket.on('terminal:error', (sid, message) => {\n          console.error('[Terminal] Error:', message);\n          setError(message);\n          xterm.write(`\\r\\n\\x1b[1;31mError: ${message}\\x1b[0m\\r\\n`);\n        });\n\n        // Handle user input\n        xterm.onData((data: string) => {\n          socket.emit('terminal:input', sessionId, data);\n        });\n\n        // Handle resize\n        xterm.onResize(({ cols, rows }: { cols: number; rows: number }) => {\n          socket.emit('terminal:resize', sessionId, cols, rows);\n        });\n\n        // Handle window resize\n        const handleResize = () => {\n          if (fitAddon) {\n            fitAddon.fit();\n          }\n        };\n\n        window.addEventListener('resize', handleResize);\n\n        return () => {\n          window.removeEventListener('resize', handleResize);\n          if (socket) {\n            socket.emit('terminal:kill', sessionId);\n            socket.disconnect();\n          }\n          if (xterm) {\n            xterm.dispose();\n          }\n        };\n      } catch (err) {\n        console.error('[Terminal] Init error:', err);\n        setError(err instanceof Error ? err.message : 'Failed to initialize terminal');\n      }\n    };\n\n    initTerminal();\n\n    return () => {\n      mounted = false;\n    };\n  }, [sessionId]);\n\n  return (\n    <div className=\"fixed inset-0 w-screen h-screen bg-black flex flex-col\">\n      {/* Status Bar */}\n      <div className=\"bg-gray-900 border-b border-gray-700 px-4 py-2 flex items-center justify-between\">\n        <div className=\"flex items-center gap-4\">\n          <span style={{ fontFamily: 'VT323, monospace' }} className=\"text-xl text-white\">\n            TERMINAL: {sessionId}\n          </span>\n          <div className=\"flex items-center gap-2\">\n            <div className={`w-2 h-2 rounded-full ${isConnected ? 'bg-green-500' : 'bg-red-500'}`} />\n            <span className=\"text-sm text-gray-400\">\n              {isConnected ? 'Connected' : 'Disconnected'}\n            </span>\n          </div>\n        </div>\n        {error && (\n          <span className=\"text-sm text-red-400\">Error: {error}</span>\n        )}\n      </div>\n\n      {/* Terminal Container */}\n      <div\n        ref={terminalRef}\n        className=\"flex-1 p-2\"\n        style={{ width: '100%', height: '100%' }}\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAMe,SAAS;IACtB,MAAM,SAAS,IAAA,+IAAS;IACxB,MAAM,YAAY,OAAO,SAAS;IAClC,MAAM,cAAc,IAAA,+MAAM,EAAiB;IAC3C,MAAM,WAAW,IAAA,+MAAM,EAAM;IAC7B,MAAM,YAAY,IAAA,+MAAM,EAAgB;IACxC,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,iNAAQ,EAAC;IAC/C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAgB;IAElD,IAAA,kNAAS,EAAC;QACR,IAAI;QACJ,IAAI;QACJ,IAAI,UAAU;QAEd,MAAM,eAAe;YACnB,IAAI;gBACF,+CAA+C;gBAC/C,MAAM,CAAC,EAAE,QAAQ,EAAE,EAAE,EAAE,QAAQ,EAAE,CAAC,GAAG,MAAM,QAAQ,GAAG,CAAC;;;iBAGtD;gBAED,IAAI,CAAC,SAAS;gBAEd,2BAA2B;gBAC3B,QAAQ,IAAI,SAAS;oBACnB,MAAM;oBACN,MAAM;oBACN,UAAU;oBACV,YAAY;oBACZ,aAAa;oBACb,OAAO;wBACL,YAAY;wBACZ,YAAY;wBACZ,QAAQ;wBACR,cAAc;wBACd,WAAW;oBACb;gBACF;gBAEA,WAAW,IAAI;gBACf,MAAM,SAAS,CAAC;gBAEhB,iBAAiB;gBACjB,IAAI,YAAY,OAAO,EAAE;oBACvB,MAAM,IAAI,CAAC,YAAY,OAAO;oBAC9B,SAAS,GAAG;oBACZ,SAAS,OAAO,GAAG;gBACrB;gBAEA,oEAAoE;gBACpE,MAAM,YAAY,sCACd,0BACA;gBAEJ,MAAM,SAAS,IAAA,8LAAE,EAAC,WAAW;oBAC3B,YAAY;wBAAC;wBAAa;qBAAU;gBACtC;gBAEA,UAAU,OAAO,GAAG;gBAEpB,OAAO,EAAE,CAAC,WAAW;oBACnB,QAAQ,GAAG,CAAC;oBACZ,eAAe;oBACf,SAAS;oBAET,0BAA0B;oBAC1B,OAAO,IAAI,CAAC,mBAAmB,WAAW;gBAC5C;gBAEA,OAAO,EAAE,CAAC,cAAc;oBACtB,QAAQ,GAAG,CAAC;oBACZ,eAAe;gBACjB;gBAEA,OAAO,EAAE,CAAC,kBAAkB,CAAC;oBAC3B,QAAQ,GAAG,CAAC,qBAAqB;oBACjC,MAAM,KAAK,CAAC;gBACd;gBAEA,OAAO,EAAE,CAAC,mBAAmB,CAAC,KAAK;oBACjC,IAAI,QAAQ,WAAW;wBACrB,MAAM,KAAK,CAAC;oBACd;gBACF;gBAEA,OAAO,EAAE,CAAC,iBAAiB,CAAC,KAAK,EAAE,QAAQ,EAAE;oBAC3C,QAAQ,GAAG,CAAC,CAAC,4BAA4B,EAAE,UAAU;oBACrD,MAAM,KAAK,CAAC,CAAC,2CAA2C,EAAE,SAAS,WAAW,CAAC;gBACjF;gBAEA,OAAO,EAAE,CAAC,kBAAkB,CAAC,KAAK;oBAChC,QAAQ,KAAK,CAAC,qBAAqB;oBACnC,SAAS;oBACT,MAAM,KAAK,CAAC,CAAC,qBAAqB,EAAE,QAAQ,WAAW,CAAC;gBAC1D;gBAEA,oBAAoB;gBACpB,MAAM,MAAM,CAAC,CAAC;oBACZ,OAAO,IAAI,CAAC,kBAAkB,WAAW;gBAC3C;gBAEA,gBAAgB;gBAChB,MAAM,QAAQ,CAAC,CAAC,EAAE,IAAI,EAAE,IAAI,EAAkC;oBAC5D,OAAO,IAAI,CAAC,mBAAmB,WAAW,MAAM;gBAClD;gBAEA,uBAAuB;gBACvB,MAAM,eAAe;oBACnB,IAAI,UAAU;wBACZ,SAAS,GAAG;oBACd;gBACF;gBAEA,OAAO,gBAAgB,CAAC,UAAU;gBAElC,OAAO;oBACL,OAAO,mBAAmB,CAAC,UAAU;oBACrC,IAAI,QAAQ;wBACV,OAAO,IAAI,CAAC,iBAAiB;wBAC7B,OAAO,UAAU;oBACnB;oBACA,IAAI,OAAO;wBACT,MAAM,OAAO;oBACf;gBACF;YACF,EAAE,OAAO,KAAK;gBACZ,QAAQ,KAAK,CAAC,0BAA0B;gBACxC,SAAS,eAAe,QAAQ,IAAI,OAAO,GAAG;YAChD;QACF;QAEA;QAEA,OAAO;YACL,UAAU;QACZ;IACF,GAAG;QAAC;KAAU;IAEd,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAK,OAAO;oCAAE,YAAY;gCAAmB;gCAAG,WAAU;;oCAAqB;oCACnE;;;;;;;0CAEb,8OAAC;gCAAI,WAAU;;kDACb,8OAAC;wCAAI,WAAW,CAAC,qBAAqB,EAAE,cAAc,iBAAiB,cAAc;;;;;;kDACrF,8OAAC;wCAAK,WAAU;kDACb,cAAc,cAAc;;;;;;;;;;;;;;;;;;oBAIlC,uBACC,8OAAC;wBAAK,WAAU;;4BAAuB;4BAAQ;;;;;;;;;;;;;0BAKnD,8OAAC;gBACC,KAAK;gBACL,WAAU;gBACV,OAAO;oBAAE,OAAO;oBAAQ,QAAQ;gBAAO;;;;;;;;;;;;AAI/C"}}]
}